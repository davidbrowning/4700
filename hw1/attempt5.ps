%!PS
/hypotrochoid {
/x exch def
/y exch def
0 1 8{
/j 1 def
newpath
y x moveto
0 1 2500 {
% 1 j cos rlineto
1 1 0 
setrgbcolor
j xt rlineto
x y div x j 1000 add div y j 2000 add div 
setrgbcolor
j yt rlineto
 /j 1 j add def
} for
stroke
/x x 1 add def
} for
} def

/xt 
{
    /t exch def
    a b sub t cos mul a b sub t mul b div cos d mul
} def

/yt 
{
    /t exch def
    a b sub t sin mul a b sub t mul b div sin d mul
} def

gsave

/a 7 def
/b 4 def
/c 2 def
/d 1 def
0 1 0
setrgbcolor
.2 .4 scale
200 250
hypotrochoid
-1.8 rotate
200 270 
hypotrochoid
-1.8 rotate
200 290 
hypotrochoid
-1.8 rotate
4 rotate
800 900 
hypotrochoid
/a 1 def
/b 5 def
/c 1 def
/d 1 def
0 0 1
setrgbcolor
2500 500
hypotrochoid

/a 1 def
/b 2 def
/c 1 def
/d 1 def
0 0 1
setrgbcolor
0 1 7{
.4 rotate
2000 1000
hypotrochoid
} for

clear
/a 1 def
/b 3 def
/c 1 def
/d 1 def
0 1 10{
1000 1600 
hypotrochoid
.4 rotate
} for
clear

/a 4 def
/b 5 def
/c 1 def
/d 1 def
0 1 10{
2400 1400 
hypotrochoid
10 10 translate
} for

clear
grestore
10 setlinewidth
newpath
10 0 moveto
10 100 lineto
stroke

25 setlinewidth
10 0 moveto
0 100 rlineto
/i .01 def
0 1 720 {
    0 1 rlineto
    1 i sub 0 i 
    setrgbcolor
    /i i .00099 add def
} for
stroke

